---
title: Simulación de modelos mixtos
author: Freddy Hernández
date: '`r format(Sys.Date(), "%Y-%B-%d")`'
output:
  html_document:
    theme: united
    highlight: pygments
    includes:
      in_header: header.md
      after_body: doc_suffix.md
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=6, fig.height=5)
```

## Introducción
En esta publicación se mostrará cómo simular datos de un:  

1. Modelo lineal clásico,  
2. Modelo lineal con intercepto aleatorio,  
3. Modelo lineal con pendiente aleatoria,  
4. Modelo lineal con intercepto y pendiente aleatoria.  

## Ilustración de un modelo mixto
Recomiendo al lector que visite el enlace mostrado abajo para que vea una ilustración muy interesante de modelos mixtos.

http://mfviz.com/hierarchical-models/

## Simulando datos de modelo lineal clásico
Suponga que queremos simular $n=50$ observaciones del siguiente modelo con vector de parámetros $\boldsymbol{\Theta}=(\beta_0=59, \beta_1=1, \sigma=1)^\top$.

\begin{align*} 
y_i &\sim N(\mu_i, \sigma^2) \\ 
\mu_i &= 59 + 1 x_i \\
\sigma &= 1 \\
x &\sim Uniforme[1, 9]
\end{align*}

Con el siguiente código se simula el conjunto de datos de interés.
```{r}
n <- 50
x <- sample(1:9, size=n, replace=TRUE)
desvi <- 1
media <- 59 + 1 * x
y <- rnorm(n=n, mean=media, sd=desvi)
```

Dibujemos los datos simulados para ver el resultado.
```{r}
plot(y ~ x)
```

Ajustemos un modelo para recuperar el vector de parámetros parámetros $\boldsymbol{\Theta}$.
```{r}
mod <- lm(y ~ x)
c(mod$coef, summary(mod)$sigma)
```

De la salida anterior vemos que vector de parámetros estimado está cerca de $\boldsymbol{\Theta}=(\beta_0=59, \beta_1=1, \sigma=1)^\top$.

Vamos a agregar la líneal del modelo ajustado.
```{r}
plot(y ~ x, pch=20)
abline(mod)
```

