---
title: Simulación de modelos mixtos
author: Freddy Hernández
date: '`r format(Sys.Date(), "%Y-%B-%d")`'
output:
  html_document:
    theme: united
    highlight: pygments
    includes:
      in_header: header.md
      after_body: doc_suffix.md
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introducción
En esta publicación se mostrará cómo simular datos de un:  
1. Modelo lineal clásico,  
2. Modelo lineal con intercepto aleatorio,  
3. Modelo lineal con pendiente aleatoria,  
4. Modelo lineal con intercepto y pendiente aleatoria.  

## Ilustración de un modelo mixto
Recomiendo al lector que visite el enlace mostrado abajo para que vea una ilustración muy interesante de modelos mixtos.

http://mfviz.com/hierarchical-models/

## Simulando datos de modelo tradicional
Suponga que queremos simular $n=50$ observaciones del siguiente modelo:

$$\begin{array}{ccc}
x_{11} & x_{12} & x_{13}\\
x_{21} & x_{22} & x_{23}
\end{array}$$

$$X = \begin{bmatrix}1 & x_{1}\\
1 & x_{2}\\
1 & x_{3}
\end{bmatrix}$$

Con el siguiente código se simula un conjunto de datos como los deseados.

```{r}
n <- 50
desvi <- 1

x <- sample(1:9, size=n, replace=TRUE)
media <- 59 + 1 * x
y <- rnorm(n=n, mean=media, sd=desvi)
```

Dibujemos los datos simulados.
```{r}
plot(y ~ x, pch=20)
```

Ajustemos un modelo para recuperar los parámetros.
```{r}
mod <- lm(y ~ x)
c(mod$coef, summary(mod)$sigma)
plot(y ~ x, pch=20)
abline(mod)
```

